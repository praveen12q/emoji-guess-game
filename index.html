<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Guess Game</title>

    <style>
        body {
            font-family: Arial;
            background: #1a1a1a;
            color: white;
            text-align: center;
            padding: 20px;
        }

        #game-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            max-width: 450px;
            margin: 20px auto;
        }

        .tile {
            background: #2a2a2a;
            padding: 25px;
            border-radius: 12px;
            font-size: 30px;
            cursor: pointer;
            transition: 0.3s;
        }

        .tile.open {
            background: #444;
            transform: scale(1.05);
        }

        .btn {
            background: #00bfff;
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 8px;
            color: black;
            cursor: pointer;
            font-weight: bold;
        }

        .hidden { display: none; }
    </style>
</head>

<body>

<h2 id="greeting"></h2>

<div id="admin-controls" class="hidden">
    <button class="btn" onclick="resetTiles()">Reset Tiles</button>
    <button class="btn" onclick="changeName()">Change Name</button>
    <a href="users.html" class="btn">View All Users</a>
</div>

<div id="game-container"></div>

<script>
    let currentUser = localStorage.getItem("current_user");

    if (!currentUser) {
        currentUser = prompt("Enter your name:");
        localStorage.setItem("current_user", currentUser);
    }

    document.getElementById("greeting").innerText =
        "Welcome, " + currentUser + "!";

    // Admin check
    if (currentUser === "Praveen") {
        document.getElementById("admin-controls").classList.remove("hidden");
    }

    // load user data or empty
    let userKey = "tiles_" + currentUser;
    let openedTiles = JSON.parse(localStorage.getItem(userKey)) || [];

    // create grid
    const container = document.getElementById("game-container");

    function createTiles() {
        container.innerHTML = "";

        for (let i = 0; i < 20; i++) {
            let div = document.createElement("div");
            div.className = "tile";

            if (openedTiles.includes(i)) {
                div.classList.add("open");
                div.innerHTML = getEmoji();
            }

            div.onclick = () => openTile(i, div);
            container.appendChild(div);
        }
    }

    function getEmoji() {
        // 90% sad, 10% smile
        return Math.random() < 0.1 ? "ðŸ™‚ (Haa)" : "ðŸ˜¢ (Nahi)";
    }

    function openTile(index, div) {
        if (!openedTiles.includes(index)) {
            openedTiles.push(index);
            div.classList.add("open");
            div.innerHTML = getEmoji();
            saveUser();
        }
    }

    function saveUser() {
        localStorage.setItem(userKey, JSON.stringify(openedTiles));
    }

    function resetTiles() {
        openedTiles = [];
        saveUser();
        createTiles();
    }

    function changeName() {
        let newName = prompt("Enter new name:");
        if (!newName) return;

        localStorage.setItem("current_user", newName);
        location.reload();
    }

    createTiles();
</script>

</body>
</html>
